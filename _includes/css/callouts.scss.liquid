{%- comment -%}
  {% include css/callouts.scss.liquid %}
  produces SCSS for all the callouts in site.callouts.
  Defines CSS variables for theming, then generates element styles once.
{%- endcomment -%}

div.opaque {
  background-color: $body-background-color;
}

{%- comment -%} Light theme: light background (000), dark border (300) {%- endcomment -%}
:root {
{%- for callout in site.callouts %}
  --callout-{{ callout[0] }}-background: #{${{ callout[1].color }}-000};
  --callout-{{ callout[0] }}-border: #{${{ callout[1].color }}-300};
{% endfor -%}
}

{%- comment -%} Dark theme: reversed for contrast {%- endcomment -%}
:root[data-theme="dark"] {
{%- for callout in site.callouts %}
  --callout-{{ callout[0] }}-background: #{${{ callout[1].color }}-300};
  --callout-{{ callout[0] }}-border: #{${{ callout[1].color }}-000};
{% endfor -%}
}

{%- comment -%} Element styles for both themes (for specificity matching) {%- endcomment -%}
:root, :root[data-theme="dark"] {
{%- for callout in site.callouts %}
{%- assign callout_opacity = callout[1].opacity | default: site.callouts_opacity | default: 0.2 -%}

  p.{{ callout[0] }}, blockquote.{{ callout[0] }} {
      background: color-mix(in srgb, var(--callout-{{ callout[0] }}-background) {{ callout_opacity | times: 100 }}%, transparent);
      border-left: $border-radius solid var(--callout-{{ callout[0] }}-border);
      border-radius: $border-radius;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12), 0 3px 10px rgba(0, 0, 0, 0.08);
      padding: .8rem;
      {% if callout[1].title %}
      &::before {
          color: var(--callout-{{ callout[0] }}-border);
          content: "{{ callout[1].title }}";
          display: block;
          font-weight: bold;
          text-transform: uppercase;
          font-size: .75em;
          padding-bottom: .125rem;
      }
      {% endif %}
      > .{{ callout[0] }}-title {
        color: var(--callout-{{ callout[0] }}-border);
        display: block;
        font-weight: bold;
        text-transform: uppercase;
        font-size: .75em;
        padding-bottom: .125rem;
      }
  }

  p.{{ callout[0] }}-title, blockquote.{{ callout[0] }}-title {
      background: color-mix(in srgb, var(--callout-{{ callout[0] }}-background) {{ callout_opacity | times: 100 }}%, transparent);
      border-left: $border-radius solid var(--callout-{{ callout[0] }}-border);
      border-radius: $border-radius;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.12), 0 3px 10px rgba(0, 0, 0, 0.08);
      padding: .8rem;
      > p:first-child {
        margin-top: 0;
        margin-bottom: 0;
        color: var(--callout-{{ callout[0] }}-border);
        display: block;
        font-weight: bold;
        text-transform: uppercase;
        font-size: .75em;
        padding-bottom: .125rem;
      }
  }

  blockquote.{{ callout[0] }} {
    margin-left: 0;
    margin-right: 0;

    > p:first-child {
      margin-top: 0;
    }

    > p:last-child {
      margin-bottom: 0;
    }
  }

  blockquote.{{ callout[0] }}-title {
    margin-left: 0;
    margin-right: 0;

    > p:nth-child(2) {
      margin-top: 0;
    }

    > p:last-child {
      margin-bottom: 0;
    }
  }

{% endfor -%}
}
